<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <% {            
      'jquery/3.2.0' => 'jquery.min.js',
      'popper.js/1.11.0' => 'umd/popper.min.js',
      'twitter-bootstrap/4.0.0-beta' => 'js/bootstrap.min.js',
      'select2/3.5.2' => 'select2.min.js select2.min.css',
      'jquery-timeago/1.4.3' => 'jquery.timeago.min.js',      
      'Chart.js/2.7.0' => 'Chart.bundle.min.js'
      }.each { |k,v| %>    
      <% v.split(' ').each { |f| u = "https://cdnjs.cloudflare.com/ajax/libs/#{k}/#{f}" %>
        <% case f.split('.').last.to_sym; when :js %>
          <script src="<%=u%>"></script>      
        <% when :css %>
          <link rel="stylesheet" href="<%=u%>" />
        <% end %>
      <% } %>
    <% } %>

    <% [
      '/stylesheets/share.css',
      "/stylesheets/app.css?#{Time.now.to_i}",
      ].each { |f| %> 
      <link rel="stylesheet" href="<%=f%>" />    
    <% } %>

    <% [
      "//maps.googleapis.com/maps/api/js?libraries=places&key=#{ENV['GOOGLE_MAPS_API_KEY']}",
      '//cdn.rawgit.com/mahnunchik/markerclustererplus/736b0e3a7d916fbeb2ee5007494f17a5329b11a8/src/markerclusterer.js',
      '//cdn.rawgit.com/wordsandwriting/activate-tools/f39002fcc10a9a554c651543b3065847130c2811/js/jquery.geopicker.js',      
      '//use.fontawesome.com/releases/v5.0.6/js/all.js',
      '//cdn.rawgit.com/davidshimjs/qrcodejs/06c7a5e134f116402699f03cda5819e10a0e5787/qrcode.min.js',
      "//cdn.rawgit.com/wordsandwriting/activate-tools/7a73525b76c8234a4803e3196b4403ec6fd6ded7/js/textboxio/textboxio.js",
      "/javascripts/app.js?#{Time.now.to_i}"
      ].each { |f| %>
      <script src="<%=f%>"></script>
    <% } %>  

    <%= favicon_tag 'favicon.png' %>
    <title><%=if @title; "#{@title} · Stephen Reid"; else; "Stephen Reid"; end %></title>
    <meta name="description" content="<%=@og_desc%>">
    <meta property="og:title" content="<%=@title%>" />
    <meta property="og:image" content="<%=@og_image%>" />

    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>

  </head>
  <body>

    <div id="fb-root"></div>
    <script>(function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id))
          return;
        js = d.createElement(s);
        js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8&appId=619967114806800";
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));</script>    

    <div class="container">

      <%= partial :alert %>  


      <style>
        @media(min-width: 768px) {
          #sidebar { position: sticky; top: 0; padding-bottom: 1rem }
        }
      </style>

      <div class="row justify-content-center">

        <div class="col-md-3">

          <div id="sidebar">

            <style>
              #pic { text-align: center }
              @media(min-width: 768px) {
                #pic { text-align:  none }  
              }
            </style>
            <div id="pic">
              <h1 style="font-size: 2em" class="rainbow mt-2 mb-0 font-weight-bold">Stephen Reid</h1>
              <img src="<%= request.path == '/tarot' ? '/images/tarotcards.jpg' : '/images/me-ocean-sq.jpg' %>" class="rounded-circle my-3" style="max-width: 200px; width: 100%" />
            </div>

            <style>
              .icon a { font-size: 8vw; color: rgb(33, 37, 41) }
              .icon a:hover { color:  #0056b3; }
              @media(min-width: 768px) {
                .icon a { font-size: 2vw }
              }
            </style>
            <div class="row justify-content-center" style="text-align: center">
              <div class="col-12">
                <a href="mailto:stephen@stephenreid.net">stephen@stephenreid.net</a>
              </div>
              <%
              [
                ['Github'],
                ['Medium', 'https://medium.com/@stephenreid321'],
                ['Youtube', 'https://www.youtube.com/channel/UCHv6VkfPWq-Rkk2HKZ8A2BA'],                
                ['Soundcloud', 'https://soundcloud.com/stephenreid321/sets/stephen-reid'],
              [],
                ['Google Maps', 'https://www.google.co.uk/maps/contrib/102982136084858811312/reviews/', 'Stephen Reid', 'fas fa-map'],
                ['Reddit', 'https://reddit.com//user/stephenreid321'],                
                ['Are.na', 'https://www.are.na/stephen-reid', 'Stephen Reid', '✶'],                
              [],
                ['Goodreads'],
                ['IMDb', 'https://www.imdb.com/user/ur85653381/'],
              [],
                ['Facebook'],
                ['Twitter'],
                ['LinkedIn', 'https://www.linkedin.com/in/stephenreid321'],                  
              [],
                ['Ethereum', 'https://etherscan.io/address/stephenreid.eth', 'stephenreid.eth']
                ].each { |network,url,text,icon|
              %>
                <% if network %>
                  <div class="col-auto icon">
                    <a data-toggle="tooltip" title="<%=network%>: <%=text or 'stephenreid321'%>" target="_blank" href="<%=url ? url : "https://#{network}.com/stephenreid321"%>">
                      <% if !icon or icon.starts_with?('fa') %>
                        <i class="<%= icon ? icon : "fab fa-#{network.parameterize}" %>"></i>
                      <% else %>
                        <%=icon%>
                      <% end %>
                    </a>                  
                  </div>                  
                <% else %>

                <% end %>
              <% } %>
            </div>

            <div style="display: none">
              <script>
                $(function () {
                  new QRCode('qrcode', {text: '<%=@eth%>', width: 150, height: 150});
                  if (typeof web3 !== 'undefined') {
                    $('#send-eth').show()
                  }
                });
              </script>            
              <div class="my-3">
                <a href="javascript:;" onclick="$(this).hide().next().show()"><small>Show ETH address as a QR code</small></a>
                <div id="qrcode" style="display: none; width: 150px;" class="mx-auto"></div>
              </div>
              <% form_tag '', :id => 'send-eth', :onsubmit => %Q{web3.eth.sendTransaction({to:'#{@eth}', value: web3.toWei($('input[name=amount]', this).val(), 'ether')}, function(error, transactionHash) { }); return false}, :class => 'my-3 form-inline', :style => 'display: none' do %>
                Send <%= text_field_tag :amount, :class => 'mx-1 form-control', :style => 'width: 3.5rem', :value => '0.01' %> <span style="font-variant: all-small-caps">ETH</span> <%= submit_tag 'Send', :class => 'ml-1 btn btn-primary btn-sm' %>
              <% end %>
            </div>

            <div class="my-2" style="text-align: center">
              <a target="_blank" href="http://facebook.com/stephenreid321"><i class="fab fa-facebook-square"></i> Follow me on Facebook</a>
            </div>

            <!-- Begin MailChimp Signup Form -->
            <div id="mc_embed_signup" class="mt-2">
              <form action="https://stephenreid.us18.list-manage.com/subscribe/post?u=b319030fc545a24d344ab37f9&amp;id=cb2c77dedc" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
                <div id="mc_embed_signup_scroll">
                  <h4>Join my mailing list</h4>
                  <div class="mc-field-group pb-1">
                    <input type="email" value="" name="EMAIL" class="required email form-control" required="required" id="mce-EMAIL" placeholder="Email*">
                  </div>
                  <div class="mc-field-group pb-1">
                    <input type="text" value="" name="FNAME" class="form-control" id="mce-FNAME" placeholder="First name">
                  </div>
                  <div class="mc-field-group pb-1">
                    <input type="text" value="" name="LNAME" class="form-control" id="mce-LNAME" placeholder="Last name">
                  </div>
                  <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                  </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                  <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_b319030fc545a24d344ab37f9_b3033d5d75" tabindex="-1" value=""></div>
                  <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="btn btn-primary button"></div>
                </div>
              </form>
            </div>

            <!--End mc_embed_signup-->            

          </div>

        </div>

        <div class="col-md">

          <script>
            $(function () {
              $("#nav a[href^=http]").attr('target', '_blank')
            })
          </script>       

          <%= partial :nav %>

          <%= yield %>

        </div>

      </div>      

    </div>

  </body>
</html>
