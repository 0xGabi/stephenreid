<div class="row">

  <div class="col-md-6 mb-3">

    <div id="accordion" role="tablist">

      <% form_tag '', :method => :get do %>
        <% Organisation.categories.each { |k,v| %>    

          <div class="card mb-1">


            <div class="card-header" role="tab" id="heading-<%=v%>">
              <h4 class="mb-0">
                <a class="text-dark" data-toggle="collapse" href="#collapse-<%=v%>" role="button">
                  <%=k%>
                </a>
                <div class="float-right">
                  <%= radio_button_tag :category, value: v, class: 'form-check-input', onchange: 'this.form.submit()', checked: (params[:category] == v) %>
                  </div>
                </h4>
              </div>      


              <div id="collapse-<%=v%>" class="collapse" role="tabpanel" data-parent="#accordion">
                <div class="card-body pb-0">
                  <div class="row no-gutters">
                    <% Organisation.all(filter: "{Interest} = '#{v}'").shuffle.each_with_index { |organisation,i| %>
                      <div class="col-md-6 mb-3">
                        <div class="<% if i % 2 == 1 %> mx-md-3 <% end %> ">
                          <%= partial :organisation, :object => organisation %>
                        </div>
                      </div>
                    <% } %>
                  </div>
                </div>
              </div>
            </div>          

          <% } %>
        <% end %>
      
      </div>
    </div>
    <div class="col-md-6">
      <div id="map">
        <style>
          #map .organisation { width: 250px; height: 130px !important; }
        </style>      
        <%= partial :map %>
      </div>
    </div>
  </div>

  <style>
    @media(min-width: 768px) {
      #map { position: sticky; top: 1rem; }
    }
  </style>